<!DOCTYPE html>
<html>
<head>
  <title>{% block title %}Trailcam Wildlife{% endblock %}</title>

  {% load static %}
  <link rel="stylesheet" href="{% static 'wildlife/styles.css' %}">

  {% block extra_head %}{% endblock %}
</head>

<body>
  <nav class="nav">
    <div class="nav-left">
      <a class="nav-link" href="{% url 'wildlife:gallery' %}">Gallery</a>

      {% if user.is_authenticated and user.is_researcher %}
        <a class="nav-link" href="{% url 'wildlife:upload_photos' %}">Upload Photos</a>
        <a class="nav-link" href="{% url 'wildlife:cameras_list' %}">Cameras</a>
      {% endif %}
    </div>

    <div class="nav-right">
      {% if user.is_authenticated %}
        <span class="nav-greeting">Hello, {{ user.username }}!</span>
        <form class="nav-form" action="{% url 'logout' %}" method="post">
          {% csrf_token %}
          <button class="btn btn-danger" type="submit">Sign Out</button>
        </form>
      {% else %}
        <a class="nav-link" href="{% url 'login' %}?next={% url 'wildlife:gallery' %}">Sign In</a>
      {% endif %}
    </div>
  </nav>

  <main class="container">
    {% block content %}{% endblock %}
  </main>

  <!-- Modal UI removed: editors are now full pages. -->

  <script>
  // Make cards navigable: clicking a card (outside of buttons/forms) navigates
  // to the URL in its `data-edit-url` attribute. This removes the need for
  // explicit Edit buttons while preserving in-card forms (publish/delete).
  document.addEventListener("click", (e) => {
    const card = e.target.closest('.photo-card, .camera-card');
    if (!card) return;

    // If the click target is inside an interactive element, ignore it
    if (e.target.closest('button, form, a, input, select, textarea')) return;

    const url = card.dataset.editUrl;
    if (url) {
      window.location.href = url;
    }
  });
  </script>

  {% block extra_scripts %}{% endblock %}
</body>
</html>